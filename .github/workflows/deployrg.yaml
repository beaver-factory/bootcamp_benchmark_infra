name: Deploy Resource Group

on:
  push:
    paths:
    - 'azuredeploy.resourcegroup.json'
    - '.github/workflows/deployrg.yaml'

jobs:
  DeployResourceGroup:
    runs-on: ubuntu-latest
      steps:
        - name: Checkout code
          uses: actions/checkout@v2

        - name: Azure Login
          uses: azure/login@v1
          with:
            creds: ${{ secrets.AZURE_CREDENTIALS }}

        - name: Infra Deploy
            run: |
              deploymentName="rg_deployment_${{github.sha}}"
              az deployment sub create --name $deploymentName --template-file azuredeploy.resourcegroup.json --location ukwest